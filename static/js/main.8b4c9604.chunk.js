(this.webpackJsonpbubble_wars=this.webpackJsonpbubble_wars||[]).push([[0],{13:function(e,r,n){},14:function(e,r,n){},15:function(e,r,n){"use strict";n.r(r);var t=n(0),o=n(1),c=n.n(o),a=n(6),i=n.n(a),l=(n(13),n(4)),u=n(2),f=(n(14),n(7));function s(e){var r=Object(o.useRef)(null),n=e.draw;return Object(o.useEffect)((function(){var e=r.current;if(null!==e){var t=e.getContext("2d");if(null!==t){var o=0,c=0;return function e(){o++,n(t,o),c=window.requestAnimationFrame(e)}(),function(){window.cancelAnimationFrame(c)}}}}),[n]),Object(t.jsx)("canvas",Object(f.a)({ref:r},e))}var d=20,v=["none","red","player"];function p(e){switch(e){case null:return"#aaaaaa";case"red":return"#ff0000";case"player":return"#00ff00"}return"#aaaaaa"}var h=function(){var e=function(){for(var e=[{x:100,y:100,faction:"player",power:3,connections:[1,3]},{x:250,y:50,faction:"none",power:3,connections:[0,2,3]},{x:400,y:100,faction:"none",power:3,connections:[1,3]},{x:250,y:150,faction:"none",power:3,connections:[0,1,2,4,6]},{x:100,y:250,faction:"none",power:3,connections:[3,5]},{x:250,y:300,faction:"red",power:3,connections:[4,6]},{x:400,y:250,faction:"none",power:3,connections:[3,5]}],r=[],n=0;n<e.length;n++)for(var t=0;t<e[n].connections.length;t++){var o,c={n1:n,n2:e[n].connections[t]},a=!1,i=Object(u.a)(r);try{for(i.s();!(o=i.n()).done;){var l=o.value;if(c.n1===l.n1&&c.n2===l.n2||c.n1===l.n2&&c.n2===l.n1){a=!0;break}}}catch(f){i.e(f)}finally{i.f()}a||r.push(c)}return[e,r]}(),r=Object(l.a)(e,2),n=r[0],c=r[1],a=Object(o.useRef)(n),i=Object(o.useRef)(c),f=Object(o.useRef)([]),h=Object(o.useRef)(null),w=Object(o.useState)(!1),b=Object(l.a)(w,2),j=b[0],y=b[1],x=Object(o.useState)({none:{totalPower:3,controlledNodes:1},player:{totalPower:3,controlledNodes:1},red:{totalPower:3,controlledNodes:1}}),O=Object(l.a)(x,2),g=O[0],N=O[1],P=function(e,r){var n=h.current;if(h.current=function(e,r){for(var n=0;n<a.current.length;n++){var t=a.current[n],o=t.x,c=t.y;if(o-10<e&&o+10>e&&c-10<r&&c+10>r)return n}return null}(e,r),null!==h.current&&null!==n){var t=a.current[n];if("player"===t.faction){var o,c=!1,i=Object(u.a)(t.connections);try{for(i.s();!(o=i.n()).done;){var l=o.value;if(h.current===l){c=!0;break}}}catch(s){i.e(s)}finally{i.f()}c&&(f.current.push({startNode:n,endNode:h.current,power:t.power,faction:t.faction,t:0}),t.power=0,h.current=null)}}},m=function(e){if(e%60===0){var r,n={none:{totalPower:0,controlledNodes:0},red:{totalPower:0,controlledNodes:0},player:{totalPower:0,controlledNodes:0}},t=Object(u.a)(a.current);try{for(t.s();!(r=t.n()).done;){var o=r.value;n[o.faction].controlledNodes++,n[o.faction].totalPower+=o.power}}catch(d){t.e(d)}finally{t.f()}var c,i=Object(u.a)(f.current);try{for(i.s();!(c=i.n()).done;){var l=c.value;n[l.faction].totalPower+=l.power}}catch(d){i.e(d)}finally{i.f()}N(n)}if(e%50===0)for(var s=0;s<a.current.length;s++)"none"!==a.current[s].faction&&a.current[s].power++;!function(){for(var e=0;e<a.current.length;e++)if("none"!==a.current[e].faction&&"player"!==a.current[e].faction){var r,n=[],t=new Map,o=[],c=new Set,i=Object(u.a)(a.current[e].connections);try{for(i.s();!(r=i.n()).done;){var l=r.value;n.push({cur:l,prev:e,cost:1}),t.set(e,{parent:-1,cost:0})}}catch(d){i.e(d)}finally{i.f()}for(;n.length>0;){var s=n.pop();if(void 0===s)break;var v=s.cur,p=s.prev,h=s.cost;if(c.has(v)){var w=t.get(v);if(void 0===w)t.set(v,{parent:p,cost:h});else{if(!(w.cost>h))continue;t.set(v,{parent:p,cost:h})}var b,j=Object(u.a)(a.current[v].connections);try{for(j.s();!(b=j.n()).done;){var y=b.value;n.push({cur:y,prev:v,cost:h+1})}}catch(d){j.e(d)}finally{j.f()}}else if(c.add(v),"red"===a.current[v].faction){var x,O=Object(u.a)(a.current[v].connections);try{for(O.s();!(x=O.n()).done;){var g=x.value;n.push({cur:g,prev:v,cost:h+1})}}catch(d){O.e(d)}finally{O.f()}}else o.push({goal:v,cost:h})}if(o.sort((function(e,r){return e.cost-r.cost})),0!==o.length){var N=o[0];if(void 0!==N){var P,m=N.goal,S=new Set,k=Object(u.a)(a.current[e].connections);try{for(k.s();!(P=k.n()).done;){var F=P.value;S.add(F)}}catch(d){k.e(d)}finally{k.f()}if(S.has(m))("red"===a.current[m].faction&&a.current[e].power>0||a.current[e].power>a.current[m].power)&&(f.current.push({startNode:e,endNode:m,power:a.current[e].power,faction:a.current[e].faction,t:0}),a.current[e].power=0);else for(var C=m;;){if(S.has(C)){("red"===a.current[C].faction&&a.current[e].power>0||a.current[e].power>a.current[C].power)&&(f.current.push({startNode:e,endNode:C,power:a.current[e].power,faction:a.current[e].faction,t:0}),a.current[e].power=0);break}var R=t.get(C);if(void 0===R)break;C=R.parent}}}}}(),function(){for(var e=[],r=0;r<f.current.length;r++){var n=f.current[r];n.t+=.0075,n.t>=1&&e.push(r)}var t,o=Object(u.a)(e.sort((function(e,r){return r-e})));try{for(o.s();!(t=o.n()).done;){var c=t.value,i=f.current[c],l=a.current[i.endNode];l.faction===i.faction?l.power+=i.power:(l.power-=i.power,l.power<=0&&(l.power=Math.abs(l.power),l.faction=i.faction)),f.current.splice(c,1)}}catch(d){o.e(d)}finally{o.f()}}()};return Object(t.jsxs)("div",{style:{borderStyle:"solid",borderWidth:"1px",borderColor:"black",width:"500px",height:"500px"},children:[Object(t.jsx)(s,{width:"500px",height:"500px",onClick:function(e){var r=e.clientX,n=e.clientY;P(r,n)},draw:function(e,r){j||(m(r),function(e){e.clearRect(0,0,e.canvas.width,e.canvas.height);var r,n=Object(u.a)(i.current);try{for(n.s();!(r=n.n()).done;){var t=r.value,o=t.n1,c=t.n2,l=a.current[o],s=a.current[c];e.beginPath(),e.moveTo(l.x,l.y),e.lineTo(s.x,s.y),e.stroke()}}catch(M){n.e(M)}finally{n.f()}e.textAlign="center",e.textBaseline="middle";for(var v=0;v<f.current.length;v++){var w=f.current[v],b=w.startNode,j=w.endNode,y=w.power,x=w.faction,O=w.t,g=a.current[b],N=a.current[j],P=g.x*(1-O)+N.x*O,m=g.y*(1-O)+N.y*O;e.fillStyle=p(x),e.beginPath(),e.arc(P,m,10,0,2*Math.PI),e.fill(),e.fillStyle="#000000",e.fillText(y.toFixed(0),P,m)}for(var S=0;S<a.current.length;S++){var k=a.current[S],F=k.x,C=k.y,R=k.power,T=k.faction;h.current===S&&(e.fillStyle="#000000",e.fillRect(F-11,C-11,22,22)),e.fillStyle=p(T),e.fillRect(F-10,C-10,d,d),e.fillStyle="#000000",e.fillText(R.toFixed(0),F,C),e.fillText(S.toFixed(0),F+15,C)}}(e))}}),Object(t.jsx)("button",{onClick:function(){return y(!j)},children:j?"Resume":"Pause"}),Object(t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr"},children:[Object(t.jsx)("div",{children:"Faction"}),Object(t.jsx)("div",{children:"Total Power"}),Object(t.jsx)("div",{children:"Controlled Nodes"}),v.map((function(e){var r=g[e];return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)("div",{children:e}),Object(t.jsx)("div",{children:r.totalPower}),Object(t.jsx)("div",{children:r.controlledNodes})]})}))]})]})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,16)).then((function(r){var n=r.getCLS,t=r.getFID,o=r.getFCP,c=r.getLCP,a=r.getTTFB;n(e),t(e),o(e),c(e),a(e)}))};i.a.render(Object(t.jsx)(c.a.StrictMode,{children:Object(t.jsx)(h,{})}),document.getElementById("root")),w()}},[[15,1,2]]]);
//# sourceMappingURL=main.8b4c9604.chunk.js.map